
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mmondics.github.io/ocp-z-workshop/lab010/lab010-8/">
      
      
      
      
      <link rel="icon" href="../../images/openshift-logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Application Observability with Kiali - Red Hat OpenShift on IBM Z and LinuxONE Workshop</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#application-observability-with-kiali" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Red Hat OpenShift on IBM Z and LinuxONE Workshop" class="md-header__button md-logo" aria-label="Red Hat OpenShift on IBM Z and LinuxONE Workshop" data-md-component="logo">
      
  <img src="../../images/openshift-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Red Hat OpenShift on IBM Z and LinuxONE Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Application Observability with Kiali
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mmondics/ocp-z-workshop/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Red Hat OpenShift on IBM Z and LinuxONE Workshop" class="md-nav__button md-logo" aria-label="Red Hat OpenShift on IBM Z and LinuxONE Workshop" data-md-component="logo">
      
  <img src="../../images/openshift-logo.png" alt="logo">

    </a>
    Red Hat OpenShift on IBM Z and LinuxONE Workshop
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mmondics/ocp-z-workshop/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workshop-architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab Architecture
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Presentations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Presentations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../presentations/combined-presentations.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Presentation 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../presentations/combined-presentations.pdf#page=48" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Presentation 2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hands-on Lab
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../print_page/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Print Site
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#validating-istio-configuration-with-kiali" class="md-nav__link">
    <span class="md-ellipsis">
      Validating Istio Configuration with Kiali
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validating-service-mesh-application-configuration-with-kiali" class="md-nav__link">
    <span class="md-ellipsis">
      Validating Service Mesh Application Configuration with Kiali
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viewing-your-service-mesh-applications-with-kiali" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing Your Service Mesh Applications with Kiali
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#managing-service-mesh-applications-with-kiali" class="md-nav__link">
    <span class="md-ellipsis">
      Managing Service Mesh Applications with Kiali
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="application-observability-with-kiali">Application Observability with Kiali<a class="headerlink" href="#application-observability-with-kiali" title="Permanent link">&para;</a></h1>
<p><em>Kiali</em> provides visibility into your service mesh by showing you the microservices in your service mesh, and how they are connected.</p>
<p>Kiali provides an interactive graph view of your namespace in real time that provides visibility into features like circuit breakers, request rates, latency, and even graphs of traffic flows. Kiali offers insights about components at different levels, from Applications to Services and Workloads, and can display the interactions with contextual information and charts on the selected graph node or edge. Kiali also provides the ability to validate your Istio configurations, such as gateways, destination rules, virtual services, mesh policies, and more.</p>
<ol>
<li>
<p><strong>Navigate to the Kiali console located at: <a href="https://kiali-istio-system.apps.atsocppa.dmz">https://kiali-istio-system.apps.atsocppa.dmz</a></strong></p>
</li>
<li>
<p><strong>Log in with your OpenShift credentials</strong>.</p>
</li>
<li>
<p><strong>View the overview of your mesh in the Overview page that appears immediately after you log in</strong>.</p>
<p>The Overview page displays all the namespaces that have services in the mesh.</p>
<p><img alt="kiali-overiview" src="../../images/kiali-overview.png" /></p>
<p>The namespaces shown are those previously discussed in the Service Mesh Member Roll.</p>
</li>
</ol>
<h2 id="validating-istio-configuration-with-kiali">Validating Istio Configuration with Kiali<a class="headerlink" href="#validating-istio-configuration-with-kiali" title="Permanent link">&para;</a></h2>
<p>Kiali can validate your Istio resources to ensure they follow proper conventions and semantics. Any problems detected in the configuration of your Istio resources can be flagged as errors or warnings depending on the severity of the incorrect configuration.</p>
<p>You might have noticed on the Kiali overview page that there is an error somewhere within your userNN-project Istio configuration.</p>
<p><img alt="kiali-overiview-2" src="../../images/kiali-overview-2.png" /></p>
<ol>
<li>
<p>Let’s find and fix that error. <strong>In the left-side menu of the Kiali console, navigate to Istio Config, and then filter to your userNN-project namespace</strong>.</p>
<p><img alt="istio-config" src="../../images/istio-config.png" /></p>
<p>You should notice an error icon in the Configuration column for your details microservice.</p>
</li>
<li>
<p><strong>Click the details hyperlink to drill down into the microservice and scroll to the bottom of the YAML file</strong>.</p>
<p><img alt="yaml-error" src="../../images/yaml-error.png" /></p>
</li>
<li>
<p>There is an error with v2 of the details DestinationRule. <strong>For more specificity, hover over the red X to the left of the YAML file</strong>.</p>
<p><img alt="yaml-error-more" src="../../images/yaml-error-more.png" /></p>
<p>You will see the error code KIA0203 This subset’s labels are not found in any matching host. Essentially, the details DestinationRule is failing to find the v2 host for the details microservice.</p>
<p>If you look back at our Bookinfo application architecture, there is only supposed to be one version of the details microservice - v1 is the only version that exists.</p>
</li>
<li>
<p><strong>Correct the error by deleting lines 30-32 of the YAML file, resulting in the following</strong>:</p>
<p><img alt="yaml-error-fixed" src="../../images/yaml-error-fixed.png" /></p>
</li>
<li>
<p><strong>Click on the Istio Config tab in the left-side menu again to navigate back to the configuration page for your project</strong>.</p>
<p>You should no longer have any configuration issues in your Istio configuration.</p>
<p><img alt="istio-config-noerror" src="../../images/istio-config-noerror.png" /></p>
</li>
</ol>
<h2 id="validating-service-mesh-application-configuration-with-kiali">Validating Service Mesh Application Configuration with Kiali<a class="headerlink" href="#validating-service-mesh-application-configuration-with-kiali" title="Permanent link">&para;</a></h2>
<p>Along with identifying issues with the Istio configuration, Kiali can also identify issues with the <em>applications running on the Service Mesh</em>.</p>
<ol>
<li>
<p><strong>In your terminal session, introduce an invalid configuration of a service port name with the following command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc patch service details --type json -p \
&#39;[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/ports/0/name&quot;, &quot;value&quot;:&quot;foo&quot;}]&#39;
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>user01@lab061:~/istio-s390x$ oc patch service details --type json -p \
&gt; &#39;[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/ports/0/name&quot;, &quot;value&quot;:&quot;foo&quot;}]&#39;
service/details patched
</code></pre></div>
</details>
<p>If you see the <code>service/details patched</code> message as in the image above, your patch was successful.</p>
</li>
<li>
<p>Back in the Kiali web console, <strong>navigate to the Services page from the left side menu</strong>.</p>
<p><img alt="kiali-service" src="../../images/kiali-service.png" /></p>
<p>You will notice that you now have an error icon under the Configuration column for the details service.</p>
</li>
<li>
<p><strong>Click the details hyperlink and then click the Network option under Service Info</strong>.</p>
<p><img alt="service-info-error" src="../../images/service-info-error.png" /></p>
</li>
<li>
<p>Hover over the error icon to display a tool tip describing the error.</p>
<p><img alt="service-info-error-2" src="../../images/service-info-error-2.png" /></p>
<p>This error is telling you that your port name does not follow the correct syntax.</p>
</li>
<li>
<p><strong>Back in your terminal session, run the following command to correct the port name</strong>:</p>
<div class="highlight"><pre><span></span><code>    oc patch service details--type json -p \
    &#39;[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/ports/0/name&quot;, &quot;value&quot;:&quot;http&quot;}]&#39;
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>user01@lab061:~/istio-s390x$ oc patch service details --type json -p \
&gt; &#39;[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/ports/0/name&quot;, &quot;value&quot;:&quot;http&quot;}]&#39;
service/details patched
</code></pre></div>
</details>
</li>
<li>
<p><strong>Back in the Kiali console, click the blue refresh button and see that your error has been fixed</strong>.</p>
<p><img alt="service-info-noerror" src="../../images/service-info-noerror.png" /></p>
</li>
</ol>
<p>Now that our Service Mesh is configured correctly, along with the application running on top of it, let’s explore some of the other features that Kiali provides.</p>
<h2 id="viewing-your-service-mesh-applications-with-kiali">Viewing Your Service Mesh Applications with Kiali<a class="headerlink" href="#viewing-your-service-mesh-applications-with-kiali" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>To view your namespace graph, <strong>Select the Graph option in the left side menu and select your project in the namespace dropdown</strong>. The page looks similar to:</p>
<p><img alt="kiali-graph" src="../../images/kiali-graph.png" /></p>
<p>The graph represents traffic flowing through the service mesh for a period of time, generated using Istio telemetry.</p>
</li>
<li>
<p>Let’s generate some traffic into our Bookinfo application. <strong>In your terminal session, run the following command to continually send http request to the productpage</strong>:</p>
<div class="highlight"><pre><span></span><code>watch -n 1 curl -o /dev/null -s -w %{http_code} $GATEWAY_URL/productpage
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>user01@lab061:~/istio-s390x$ watch -n 1 curl -o /dev/null -s -w %{http_code} $GATEWAY_URL/productpage
Every 1.0s: curl -o /dev/null -s -w %{http_code} user01-project.istio.apps.atsocppa.dmz/productpage

200
</code></pre></div>
</details>
<p>If you see a 200 return code as in the image above, you’re now sending requests to the productpage every second.</p>
<div class="admonition important">
<p class="admonition-title"><img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/26a0.svg" title=":warning:" /> Important <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/26a0.svg" title=":warning:" /></p>
<p>Note: you will want to leave this watch command running until otherwise directed.</p>
</div>
</li>
<li>
<p><strong>Open a second terminal session and connect to the environment as directed previously in this lab</strong>.</p>
</li>
<li>
<p><strong>To view a summary of metrics, select any node or edge in the graph to display its metric details in the summary details panel on the right</strong>.</p>
<p>For example, <strong>click on the triangle representing the productpage service</strong>, and you should see a 100% success rate for both inbound and outbound traffic.</p>
<p><img alt="productpage-node" src="../../images/productpage-node.png" /></p>
</li>
<li>
<p><strong>On this same page, click the Display dropdown and select Requests Percentage and Service Nodes, if they aren’t already selected</strong>.</p>
<p><img alt="display-dropdown" src="../../images/display-dropdown.png" /></p>
<p>This will let you view the percentage of traffic to each workload in near real-time. For example, since there are three versions of the reviews microservice and traffic is being distributed in a round-robin fashion, you should see close to 33% traffic going from the productpage to each version of reviews.</p>
<p><img alt="reviews-flow" src="../../images/reviews-flow.png" /></p>
<p>Your percentages are likely not exactly 33.3%, as in the image above. More often, they will vary between 20% and 40%.</p>
</li>
</ol>
<h2 id="managing-service-mesh-applications-with-kiali">Managing Service Mesh Applications with Kiali<a class="headerlink" href="#managing-service-mesh-applications-with-kiali" title="Permanent link">&para;</a></h2>
<p>Kiali does not only allow visibility into your service mesh application, Kiali can also be used to directly interact with the application.</p>
<ol>
<li>
<p><strong>Click the reviews service represented by a triangle. In the right-side menu that pops up, click on the hyperlink for the reviews service</strong>.</p>
<p><img alt="reviews-service" src="../../images/reviews-service.png" /></p>
<p>You are taken to the Services page (instead of Graph, where you previously were). This shows expanded information about the reviews service, its properties and versions, metrics about its traffic, and more.</p>
</li>
<li>
<p><strong>Click the Actions dropdown in the top right of the page to see the traffic management options you have - Request Routing, Fault Injection, Traffic Shifting, and Request Timeouts</strong>.</p>
<p>These should all be grayed out right now because these are managed through DestinationRules, and we already created one for the reviews service in a previous step.</p>
</li>
<li>
<p><strong>Delete the Traffic Routing from this Actions dropdown and confirm that you want to delete the DestinationRule: ‘reviews’</strong>.</p>
<p><img alt="delete-traffic-routing" src="../../images/delete-traffic-routing.png" /></p>
</li>
<li>
<p><strong>Click the Actions dropdown again</strong> and you will notice that the options can now be selected and <strong>click the Traffic Shifting option</strong>.</p>
<p><img alt="traffic-shifting" src="../../images/traffic-shifting.png" /></p>
<p>From this page, you can create a new Traffic Shifting rule to manage how much traffic should be directed to each version of the reviews microservice.</p>
</li>
<li>
<p><strong>Slide the slider for reviews-v3 all the way to the left for 0%, and then make reviews-v1 and reviews-v2 50% and click create</strong>. Your page should look like the image below.</p>
<p><img alt="create-traffic-shifting" src="../../images/create-traffic-shifting.png" /></p>
</li>
<li>
<p><strong>Navigate back to the Graph page from the left side menu</strong>.</p>
<p>Over the next few minutes (and depending on the graph’s refresh rate that you can edit in the top right of the Graph page) you will see that the percentage of traffic going to v3 of reviews will decrease towards 0%, while the traffic going to v1 and v2 will increase towards 50%.</p>
<p><img alt="shifted-traffic" src="../../images/shifted-traffic.png" /></p>
</li>
<li>
<p><strong>In your web browser, navigate back to your bookinfo productpage and refresh the page a few times</strong>.</p>
<p>No matter how many times you refresh, you will not see the red stars again. That is because no traffic can reach v3 of the reviews microservice, which is the version that provides red stars.</p>
</li>
</ol>
<p>As you can tell from the past few sections, you can control Service Mesh applications either from the Command Line by creating VirtualServices and DestinationRules, or by using the Kiali GUI console. Using the Kiali console simply generates the VirtualServices and DestinationRules for you, however the Command Line offers greater flexibility, more control, and the ability to automate the creation of these rules.</p>
<p>We will now move on from Kiali to Jaeger, the tool that OSSM uses for distributed tracing. At this point, feel free to explore Kiali and the other functions it provides. There are many things Kiali can do that we will not be covering in this lab. You can find more information in the Kiali documentation here: <a href="https://kiali.io/documentation/latest/features/">https://kiali.io/documentation/latest/features/</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2024 IBM Z Washington Systems Center
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
    
  </body>
</html>